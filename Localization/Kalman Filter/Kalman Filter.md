# 칼만필터는 어렵지 않아

### Chapter 01. 평균 필터

$$\overline{x_k} = \frac{x_1 + x_2 + ... + x_k}{k}$$

**평균의 재귀식** -> 저주파 통과 필터, 칼만 필터에 사용되는 개념이다.<br>
재귀식은 이전 결과를 재사용하기 때문에 **메모리 효율**면에서 좋다.<br>
재귀식이라면 이전 평균값, 추가된 데이터, 데이터 개수만 가지고도 새로운 평균을 구해낼 수 있다.

$$\overline{x_k} = \frac{k-1}{k} \overline{x_{k-1}} + \frac{1}{k} x_k$$

위와 같은 형태의 식을 **평균 필터** 라고 한다.

**[평균 필터의 특징]**
1. 평균 필터는 평균 계산 외에도 **센서 초기화**에서도 유용하게 사용된다.
2. 어떤 물리량의 측정값을 평균하면 잡음이 제거된다는 특징을 가진다.
3. 데이터를 실시간으로 처리해야 한다면 재귀식 형태의 필터가 필수적이다.


### Chapter 02. 이동 평균 필터
EX) 5일 이평선 : 5일 동안의 주가에 대한 이동평균을 낸 후 그 값을 이은 그래프

평균을 취하면 측정 데이터에서 잡음을 제거할 수 있지만, 측정하려는 **물리량이 시간에 따라 변하는 경우** 평균을 취하는 것은 적절하지 않다. 평균은 데이터의 동적인 변화를 모두 없애기 때문이다.

**이동 평균** : 모든 측정 데이터가 아닌, **지정한 개수의 최근 측정값**만 가지고 계산한 평균이다.

$$\overline{x_k} = \frac{x_{k-n+1}+x_{k-n+2}+...+x_{k}}{n}$$

위의 이동 평균의 경우 k-n+1 번째 데이터부터 k 번째 데이터까지 총 **n개 데이터의 평균**이 구해짐을 알 수 있다.

$$\overline{x_{k-1}} = \frac{x_{k-n}+x_{k-n}+...+x_{k-1}}{n}$$

두 식을 비교할 때, $\overline{x_k}$는 $\overline{x_{k-1}}$에서 가장 오래된 $x_{k-n}$을 빼고, $x_{k}$를 추가한 것을 알 수 있다.

$$\overline{x_{k}} = \overline{x_{k-1}} + \frac{x_{k}-x_{k-n}}{n}$$

으로 정리된다. 그러나 위의 식의 경우 어차피 분모의 데이터 개수는 n개로 항상 일정하며, 어차피 최근 데이터 $x_{k}$를 포함해 n개의 최근 데이터가 모두 보관되어 있어야 하기에 메모리 저장 공간 측면에서도 큰 이득은 없다.